function t(t){return t&&t.__esModule?t.default:t}var e=t(require("fast-html-parser")),n=t(require("urlencode")),r={a:{init:function(t){let e=t.rawAttrs.split(" "),n="";e.map((t=>{"href"==t.split("=")[0]&&(n=t.split("=")[1])})),this.start=this.start.replace("${link}",n)},start:"{\\field{\\*\\fldinst{HYPERLINK ${link}}}{\\fldrslt \\f0\\fs24 \\cf0",end:"}}}"},ol:{start:"{{\\*\\pn\\pnlvlbody\\pnf0\\pnindent0\\pnstart1\\pndec{\\pntxta.}}\\fi-360\\li720\\sa200\\sl276\\slmult1",end:"}"},ul:{start:"{{\\*\\pn\\pnlvlblt\\pnf1\\pnindent0{\\pntxtb\\'B7}}\\fi-360\\li720\\sa200\\sl276\\slmult1\\lang22\\f0\\fs22",end:"}"},li:{start:"{\\pntext\\tab}",end:"\\par"},center:{start:"{\\pard\\qr",end:"\\par}"},table:{start:"{",end:"}"},td:{start:"{\\pard\\intbl\\qc",end:"\\cell}"},th:{start:"{\\pard\\intbl\\qc",end:"\\cell}"},tr:{start:"{\\trowd\\trgaph10",end:"\\row}"},sup:{start:"{\\super",end:"}"}};var l=function(t){return t=parseFloat(t),"\\fs"+Math.trunc(1.25*t)},a=function(t){return"\\sl"+200*t},i=function(t){return"\\sa"+300*(t=parseFloat(t))},s=function(t){if("2em"==t||"space"==t){return t=parseFloat(t),"\\fi"+300*margin+" "}return""},o="";const d=t=>{let e=t.tagName,n="";if(["div","p","h1","h2","h3","h4","h5","h6"].includes(e))n=p(t,"{\\pard ","\\sb70\\par}");else if(["b","i","u","sub"].includes(e))n=p(t,`{\\${e}`,"}");else if(["a","ol","ul","li","center","table","td","th","tr","sup"].includes(e)){let l=r[e];l.init&&l.init(t),n=p(t,l.start,l.end)}else n=p(t);return n},c=t=>{if(!t.rawAttrs)return;let e=t.attributes.style;return u(e)},p=(t,e,r)=>{let l="";if(e=e||"",r=r||"",o=c(t)?c(t):o,t.childNodes&&0!==t.childNodes.length){l+=e;let n=h(t.childNodes);l=n?l+n+r:""}else if(t.rawText&&"&emsp;&emsp;"!==t.rawText){console.log(o),l+=e+o,l+=`${(t=>{if(t=t.replace(/&emsp;&emsp;/g,(function(){return""})),!new RegExp("[\\u4E00-\\u9FFF]","g").test(t))return t;let e=n(t,"GBK");return e=e.replace(/%/g,"\\'"),e})(t.rawText)}${r}`}return l},u=t=>{let e=f(t),n="",r=e["font-size"],o=e["line-height"],d=e["margin-top"],c=e["text-indent"];e.color;return n+=r?l(r):"",n+=o?a(o):"",n+=d?i(d):"",n+=c?s(c):"",n},f=t=>{let e=t.split(";"),n={};for(let t of e)if(t){let e=t.split(":");n[e[0].trim()]=e[1].trim()}return n},h=t=>{let e="";for(let n of t)e+=d(n);return e};const m=()=>{const t=Array.from(document.querySelectorAll(".pager ~ ol > li")),n=document.querySelector("p.res:nth-child(2n)").textContent.trim().replaceAll('"',""),r=`\n    <ol>\n      ${t.map((t=>({heading:t.querySelector("span.b-doc-expl").textContent.trim(),text:t.querySelector("li").textContent.trim().replace("\n\n             \n            [омонимия снята]\n            \n\n\n             \n             ←…→","").replace("\n\n             \n            [омонимия не снята]\n            \n\n\n             \n             ←…→","").replace("\n             ","").replaceAll(n,`<b>${n}</b>`)}))).map((t=>`\n    <li>\n      <p><b>${t.heading}</b></p>\n      <p>${t.text}</p>\n    </li>\n  `)).join("\n")}\n    </ol>\n  `;try{throw new Error("")}catch(t){console.log(t)}((t,e,n)=>{const r=new Blob([t],{type:e}),l=document.createElement("a");l.download=n,l.href=URL.createObjectURL(r),l.dataset.downloadurl=[e,l.download,l.href].join(":"),l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),setTimeout((()=>URL.revokeObjectURL(l.href)),1500)})((t=>{let n="{\\rtf1\\ansi\\ansicpg936\\cocoartf1504\\cocoasubrtf830{\\fonttbl {\\f0 \\fnil \\fcharset134 }}{\\colortbl;\\red255\\green255\\blue255;\\red246\\green250\\blue211;}",r=e.parse(t);return n=n+h(r.childNodes)+"\\par}",n})(r),"text/rtf","results.rtf")};"interactive"===document.readyState||"complete"===document.readyState?m():document.addEventListener("DOMContentLoaded",m);